# Doc

~~1. 代码主逻辑负责赋予状态，余下的交给引擎处理；~~

~~2. 地图基于数组，字典；该字典key为坐标，value为包含物品的list~~

1. 引擎仅用于总管整合所有组件和资源;
2. 地图基于二维数组，物品使用list存储，采用即时查找;

## 输入处理

### 键盘输入

input_handler 只负责将原始pygame时间映射为游戏内部使用的action，并放在input_handler的current_action变量内。

## 行为系统

单独用一族类, 定义一组标准行为; 这些标准行为对绝大多数的实体各自执行相应的逻辑; 但也允许实体自己重写.

1. 检测该行为是否被实体重写; 重写则进入3, 否则进入2;
2. 执行该行为的标准逻辑, 结束.
3. 执行实体重写的逻辑, 结束.

## 时间系统

时间系统使用一个优先队列实现，每个实体都有一个负责时间记录变量，该变量作为排序的key。

由一个死循环驱动，不断从优先队列中取出时间最小的实体，让该实体做出相应动作，更新自己的时间，之后再将其放回优先队列。

实体做出动作后会给时间系统给一个反馈，该反馈会指明时间系统是否break。一定要有break，否则会卡死。

## 命名说明

1. xy 指 地图数组的位置
2. pos 指 渲染时的位置
3. offset 指 渲染时的偏移量
4. pos_offset 指 渲染时偏移修正后的位置